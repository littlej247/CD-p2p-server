<!DOCTYPE html>
<html>
<head>
   <title>cSecure</title>
</head>
<body>
 <div>
    <label>Initieator option</label><input id='init' type="checkbox"/><br>
    <label>Offer id if initiator</label><input id='token' /><br>
    <input type="button" id ='startScript' onclick="startScript();" value="Start script"/><br>
    <input id='message' /><input type="button" id="sendMessage" value="Send message"/><br>
</div>
<p>
    <input type="button" id ='upgrade' value="Upgrade"/><br>


<script src="https://ide.cumberlandapartments.ca/js/socket.io.min.js"></script>
<!--  <script src="https://ide.cumberlandapartments.ca/js/peerjs.min.js"></script>  -->
<script src="https://ide.cumberlandapartments.ca/js/socketiop2p.min.js"></script>
<script> 

var msgBox = document.getElementById('message');
msgBox.value = getRandomTitle();



function startScript(){

    var manager = new io.Manager({ transports: ['websocket'] });
    var Opts = {
        peerOpts: {
            trickle:    true //,
            //initiator:  document.getElementById('init').checked
        },
        autoUpgrade: false
    }
    var socket = manager.socket('/controllerData');
    //var socket = new io('/controllerData');
    window.p2psocket = new P2P(socket, Opts, ()=>{
        console.log('We all speak WebRTC now');
    });


    // this event will be triggered over the socket transport
    p2psocket.on('message', function (data) {
        console.log('message: ', data);
    })




    p2psocket.on('ready', function () {
    p2psocket.usePeerConnection = true
        console.log('onready called');
    });

    document.getElementById('sendMessage').onclick = ()=>{
        p2psocket.emit('message',msgBox.value);
        msgBox.value = getRandomTitle();
    }

    var goPrivate = document.getElementById('upgrade')
    goPrivate.onclick = ()=>{
        p2psocket.useSockets = false;
        goPrivate.disabled = true;
        console.log('connection should be private');
    }













}


    //Get a fun random title incase one isn't specified
    function getRandomTitle(){
          var myArray = ["Whoa...","But....But....","Hold on a sec..","O Geeze..","I don't know Rick..","My man!",
             "S-S-Samantha.","Puh rum pum pow!","dont mind those stare goblins","Oh, wow.","Awww, it's you guys!",
             "Wubbalubbadubdub!","Uh ohhhh! Somersoult jump!","GRASSSSS... tastes bad!","No jumping in the sewer.",
             "BURGERTIME!","Rubber baby buggy bumpers!","I turned myself into a PICKLE!","Heavens to Murgatroyd!",
             "Hey hey hey!","You blockhead!","That's all I can stands, I can't stands no more!","Beep Beep",
             "And now, here's something we hope you'll really like.","Excellent.","Wonder Twin powers activate!",
             "Scooby-Dooby-Doo!","Sufferin' succotash!","Ay, caramba!","By the power of Greyskull!","Good grief.","D'oh!",
             "What's up, doc?","Giggity","Mmmkay","Lambs to the cosmic slaughter!","Keep Summer... safe!"
          ];
          return (myArray[Math.floor(Math.random()*myArray.length)]);
    }
</script>
</body>
</html>